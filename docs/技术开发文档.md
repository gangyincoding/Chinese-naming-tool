# 宝宝起名工具 - 技术开发文档

## 1. 技术架构设计

### 1.1 整体架构

```
┌─────────────────────────────────────────────────┐
│                   用户界面层                      │
│  (Vue 3 Components + Element Plus)              │
└────────────────┬────────────────────────────────┘
                 │
┌────────────────┴────────────────────────────────┐
│                   状态管理层                      │
│        (Pinia Store - 全局状态管理)              │
└────────────────┬────────────────────────────────┘
                 │
┌────────────────┴────────────────────────────────┐
│                   业务逻辑层                      │
│   (API调用 / 八字计算 / 数据处理)                 │
└────────────────┬────────────────────────────────┘
                 │
┌────────────────┴────────────────────────────────┐
│                   数据层                         │
│  (LocalStorage + AI API + 浏览器缓存)            │
└─────────────────────────────────────────────────┘
```

### 1.2 技术栈选型

#### 前端框架与工具
| 技术 | 版本 | 用途 |
|------|------|------|
| Vue.js | 3.4+ | 前端框架 |
| Vite | 5.0+ | 构建工具 |
| TypeScript | 5.0+ | 类型检查 |
| Element Plus | 2.5+ | UI组件库 |
| Pinia | 2.1+ | 状态管理 |
| Vue Router | 4.0+ | 路由管理 |

#### 工具库
| 库名 | 用途 |
|------|------|
| axios | HTTP请求 |
| dayjs | 日期处理 |
| gsap | 动画效果 |
| html2canvas | 导出图片 |
| jspdf | 导出PDF |
| lunar-javascript | 农历和八字计算 |

#### 开发工具
- ESLint + Prettier：代码规范
- Husky：Git Hooks
- Commitlint：提交信息规范

---

## 2. 项目结构

```
Chinese-naming-tool/
├── .vscode/                # VSCode配置
├── docs/                   # 文档目录
│   ├── 产品需求文档.md
│   └── 技术开发文档.md
├── public/                 # 静态资源
│   ├── favicon.ico
│   └── images/            # 水墨画等装饰图片
│       ├── ink-bg.png
│       ├── bamboo.svg
│       └── seal.png
├── src/
│   ├── assets/            # 资源文件
│   │   ├── fonts/        # 字体文件
│   │   ├── images/       # 图片资源
│   │   └── styles/       # 全局样式
│   │       ├── variables.scss    # CSS变量
│   │       ├── mixins.scss       # Sass混合
│   │       ├── reset.scss        # 样式重置
│   │       └── chinese-style.scss # 中国风样式
│   ├── components/        # 组件目录
│   │   ├── common/        # 通用组件
│   │   │   ├── InkLoading.vue       # 水墨加载动画
│   │   │   ├── ScrollAnimation.vue  # 卷轴动画
│   │   │   ├── SealStamp.vue        # 印章组件
│   │   │   └── InkButton.vue        # 水墨风格按钮
│   │   ├── naming/        # 起名相关组件
│   │   │   ├── NameCard.vue         # 名字卡片
│   │   │   ├── NameDetail.vue       # 名字详情
│   │   │   ├── BaziInput.vue        # 八字输入表单
│   │   │   ├── SurnameInput.vue     # 姓氏输入表单
│   │   │   ├── NameFilter.vue       # 筛选组件
│   │   │   └── NameComparison.vue   # 名字对比组件
│   │   └── layout/        # 布局组件
│   │       ├── Header.vue
│   │       ├── Footer.vue
│   │       └── Sidebar.vue
│   ├── views/             # 页面视图
│   │   ├── Home.vue              # 首页
│   │   ├── NameList.vue          # 名字列表页
│   │   ├── Collection.vue        # 收藏页
│   │   ├── Comparison.vue        # 对比页
│   │   └── Guide.vue             # 使用说明
│   ├── stores/            # Pinia状态管理
│   │   ├── naming.ts             # 起名相关状态
│   │   ├── collection.ts         # 收藏状态
│   │   ├── filter.ts             # 筛选状态
│   │   └── app.ts                # 应用全局状态
│   ├── api/               # API接口
│   │   ├── ai.ts                 # AI接口调用
│   │   └── types.ts              # 类型定义
│   ├── utils/             # 工具函数
│   │   ├── bazi.ts               # 八字计算工具
│   │   ├── wuxing.ts             # 五行计算工具
│   │   ├── validator.ts          # 表单验证工具
│   │   ├── storage.ts            # LocalStorage封装
│   │   ├── export.ts             # 导出功能
│   │   └── prompt.ts             # AI Prompt模板
│   ├── types/             # TypeScript类型定义
│   │   ├── name.ts
│   │   ├── bazi.ts
│   │   └── common.ts
│   ├── router/            # 路由配置
│   │   └── index.ts
│   ├── App.vue            # 根组件
│   ├── main.ts            # 入口文件
│   └── env.d.ts           # 环境变量类型
├── .env.development       # 开发环境变量
├── .env.production        # 生产环境变量
├── .eslintrc.js           # ESLint配置
├── .prettierrc            # Prettier配置
├── tsconfig.json          # TypeScript配置
├── vite.config.ts         # Vite配置
├── package.json           # 项目依赖
└── README.md              # 项目说明
```

---

## 3. 核心模块设计

### 3.1 TypeScript类型定义

#### src/types/name.ts
```typescript
// 名字基本信息
export interface Name {
  id: string
  surname: string           // 姓氏
  givenName: string         // 名
  fullName: string          // 全名
  pinyin: string            // 拼音
  source: NameSource        // 出处
  meaning: string           // 寓意
  characters: Character[]   // 字符详情
  score: NameScore          // 评分
  createdAt: number         // 生成时间
}

// 典籍来源
export interface NameSource {
  book: string              // 典籍名称
  chapter?: string          // 章节
  verse: string             // 原文诗句
  interpretation: string    // 诗句释义
}

// 单个字的信息
export interface Character {
  char: string              // 汉字
  meaning: string           // 字义
  wuxing: WuXing            // 五行属性
  stroke: number            // 笔画数
}

// 五行枚举
export type WuXing = '金' | '木' | '水' | '火' | '土'

// 名字评分
export interface NameScore {
  culture: number           // 文化底蕴 (1-5)
  harmony: number           // 音韵和谐 (1-5)
  wuxing: number            // 五行匹配 (1-5)
  overall: number           // 综合评分 (0-100)
}

// 起名请求参数
export interface NamingRequest {
  mode: 'surname' | 'bazi'  // 起名模式
  surname: string           // 姓氏
  gender?: 'male' | 'female' | 'neutral' // 性别
  bazi?: BaziInfo           // 八字信息（八字模式）
  count?: number            // 生成数量，默认10
  filter?: NamingFilter     // 筛选条件
}

// 筛选条件
export interface NamingFilter {
  source?: string[]         // 典籍来源
  wuxing?: WuXing[]         // 五行属性
  charCount?: 1 | 2         // 名字字数
  gender?: 'male' | 'female' | 'neutral'
}
```

#### src/types/bazi.ts
```typescript
// 生辰八字信息
export interface BaziInfo {
  year: number              // 出生年
  month: number             // 出生月
  day: number               // 出生日
  hour: number              // 出生时
  gender: 'male' | 'female' // 性别
  lunar?: LunarDate         // 农历日期
  bazi?: BaziResult         // 八字结果
}

// 农历日期
export interface LunarDate {
  year: string              // 农历年（如：甲子）
  month: string             // 农历月
  day: string               // 农历日
}

// 八字计算结果
export interface BaziResult {
  yearGanZhi: string        // 年柱（如：甲子）
  monthGanZhi: string       // 月柱
  dayGanZhi: string         // 日柱
  hourGanZhi: string        // 时柱
  wuxingCount: WuXingCount  // 五行统计
  xiyongshen: WuXing[]      // 喜用神
  jinji: WuXing[]           // 忌神
}

// 五行统计
export interface WuXingCount {
  金: number
  木: number
  水: number
  火: number
  土: number
}
```

### 3.2 AI接口模块

#### src/api/ai.ts
```typescript
import axios from 'axios'
import { Name, NamingRequest } from '@/types/name'
import { generatePrompt } from '@/utils/prompt'

const API_BASE_URL = import.meta.env.VITE_AI_API_URL
const API_KEY = import.meta.env.VITE_AI_API_KEY

// 创建axios实例
const aiClient = axios.create({
  baseURL: API_BASE_URL,
  timeout: 30000,
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${API_KEY}`
  }
})

/**
 * 调用AI生成名字
 */
export async function generateNames(request: NamingRequest): Promise<Name[]> {
  try {
    // 生成提示词
    const prompt = generatePrompt(request)

    // 调用AI API
    const response = await aiClient.post('/chat/completions', {
      model: 'gpt-4',  // 或其他模型
      messages: [
        {
          role: 'system',
          content: '你是一个精通中国古典文学的起名专家，擅长从诗经、楚辞等典籍中挑选优美的名字。'
        },
        {
          role: 'user',
          content: prompt
        }
      ],
      temperature: 0.8,
      max_tokens: 2000
    })

    // 解析AI返回的数据
    const content = response.data.choices[0].message.content
    const names = parseAIResponse(content, request.surname)

    return names
  } catch (error) {
    console.error('AI生成名字失败:', error)
    throw new Error('名字生成失败，请稍后重试')
  }
}

/**
 * 解析AI返回的JSON数据
 */
function parseAIResponse(content: string, surname: string): Name[] {
  try {
    const data = JSON.parse(content)
    return data.names.map((item: any) => ({
      ...item,
      id: generateId(),
      surname,
      fullName: surname + item.givenName,
      createdAt: Date.now()
    }))
  } catch (error) {
    console.error('解析AI响应失败:', error)
    throw new Error('数据解析失败')
  }
}

/**
 * 生成唯一ID
 */
function generateId(): string {
  return `name_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`
}
```

### 3.3 八字计算模块

#### src/utils/bazi.ts
```typescript
import { Lunar, Solar } from 'lunar-javascript'
import { BaziInfo, BaziResult, WuXingCount, WuXing } from '@/types/bazi'

/**
 * 计算生辰八字
 */
export function calculateBazi(info: BaziInfo): BaziResult {
  // 转换为solar对象
  const solar = Solar.fromYmdHms(
    info.year,
    info.month,
    info.day,
    info.hour,
    0,
    0
  )

  // 获取农历对象
  const lunar = solar.getLunar()

  // 获取八字
  const baziObj = lunar.getEightChar()

  // 年月日时四柱
  const yearGanZhi = baziObj.getYearInGanZhi()
  const monthGanZhi = baziObj.getMonthInGanZhi()
  const dayGanZhi = baziObj.getDayInGanZhi()
  const hourGanZhi = baziObj.getTimeInGanZhi()

  // 计算五行统计
  const wuxingCount = calculateWuXingCount(baziObj)

  // 计算喜用神和忌神
  const { xiyongshen, jinji } = calculateXiYongShen(wuxingCount, info.gender)

  return {
    yearGanZhi,
    monthGanZhi,
    dayGanZhi,
    hourGanZhi,
    wuxingCount,
    xiyongshen,
    jinji
  }
}

/**
 * 统计五行数量
 */
function calculateWuXingCount(baziObj: any): WuXingCount {
  const count: WuXingCount = {
    '金': 0,
    '木': 0,
    '水': 0,
    '火': 0,
    '土': 0
  }

  // 天干五行
  const ganWuXing = {
    '甲': '木', '乙': '木',
    '丙': '火', '丁': '火',
    '戊': '土', '己': '土',
    '庚': '金', '辛': '金',
    '壬': '水', '癸': '水'
  }

  // 地支五行
  const zhiWuXing = {
    '子': '水', '丑': '土', '寅': '木', '卯': '木',
    '辰': '土', '巳': '火', '午': '火', '未': '土',
    '申': '金', '酉': '金', '戌': '土', '亥': '水'
  }

  // 获取八字的天干地支
  const ganList = [
    baziObj.getYearGan(),
    baziObj.getMonthGan(),
    baziObj.getDayGan(),
    baziObj.getTimeGan()
  ]

  const zhiList = [
    baziObj.getYearZhi(),
    baziObj.getMonthZhi(),
    baziObj.getDayZhi(),
    baziObj.getTimeZhi()
  ]

  // 统计天干五行
  ganList.forEach(gan => {
    const wx = ganWuXing[gan]
    if (wx) count[wx as WuXing]++
  })

  // 统计地支五行
  zhiList.forEach(zhi => {
    const wx = zhiWuXing[zhi]
    if (wx) count[wx as WuXing]++
  })

  return count
}

/**
 * 计算喜用神和忌神
 */
function calculateXiYongShen(
  wuxingCount: WuXingCount,
  gender: 'male' | 'female'
): { xiyongshen: WuXing[], jinji: WuXing[] } {
  // 找出最少和最多的五行
  const sorted = Object.entries(wuxingCount)
    .sort((a, b) => a[1] - b[1])

  // 缺失或最少的作为喜用神
  const xiyongshen: WuXing[] = []
  const jinji: WuXing[] = []

  sorted.forEach((item, index) => {
    if (index < 2) {
      xiyongshen.push(item[0] as WuXing)
    } else if (index >= sorted.length - 2) {
      jinji.push(item[0] as WuXing)
    }
  })

  return { xiyongshen, jinji }
}

/**
 * 获取五行相生关系
 */
export function getWuXingSheng(wuxing: WuXing): WuXing {
  const shengMap: Record<WuXing, WuXing> = {
    '金': '水',
    '水': '木',
    '木': '火',
    '火': '土',
    '土': '金'
  }
  return shengMap[wuxing]
}

/**
 * 获取五行相克关系
 */
export function getWuXingKe(wuxing: WuXing): WuXing {
  const keMap: Record<WuXing, WuXing> = {
    '金': '木',
    '木': '土',
    '土': '水',
    '水': '火',
    '火': '金'
  }
  return keMap[wuxing]
}
```

### 3.4 AI Prompt设计

#### src/utils/prompt.ts
```typescript
import { NamingRequest } from '@/types/name'
import { WuXing } from '@/types/bazi'

/**
 * 生成AI提示词
 */
export function generatePrompt(request: NamingRequest): string {
  if (request.mode === 'surname') {
    return generateSurnamePrompt(request)
  } else {
    return generateBaziPrompt(request)
  }
}

/**
 * 按姓氏起名的Prompt
 */
function generateSurnamePrompt(request: NamingRequest): string {
  const { surname, gender, count = 10 } = request

  const genderText = gender === 'male' ? '男孩'
    : gender === 'female' ? '女孩'
    : '中性'

  return `
请为姓"${surname}"的${genderText}推荐${count}个名字，要求如下：

1. **来源要求**：
   - 所有名字必须严格来源于中国古典文献，包括但不限于：
     * 《诗经》（风、雅、颂）
     * 《楚辞》
     * 唐诗、宋词
     * 《周易》、《论语》、《孟子》等经典
   - 不可随意组合，必须有明确出处

2. **名字要求**：
   - 音韵优美，读音流畅
   - 寓意美好，富有文化内涵
   - 适合现代使用，避免生僻字
   - 男孩名字阳刚大气，女孩名字婉约优雅

3. **输出格式**：
   - 必须严格按照以下JSON格式输出，不要有任何额外文字：

\`\`\`json
{
  "names": [
    {
      "givenName": "清照",
      "pinyin": "qīng zhào",
      "source": {
        "book": "诗经·大雅·烝民",
        "chapter": "大雅",
        "verse": "吉甫作颂，穆如清风",
        "interpretation": "美好的诗歌如清风般温和美好"
      },
      "meaning": "名字寓意纯洁明亮，如清风明月般高洁，象征着纯净的心灵和光明的前程",
      "characters": [
        {
          "char": "清",
          "meaning": "清澈、纯洁、清明",
          "wuxing": "水",
          "stroke": 11
        },
        {
          "char": "照",
          "meaning": "照耀、明亮、光明",
          "wuxing": "火",
          "stroke": 13
        }
      ],
      "score": {
        "culture": 5,
        "harmony": 5,
        "wuxing": 4,
        "overall": 95
      }
    }
  ]
}
\`\`\`

4. **评分标准**：
   - culture（文化底蕴）：1-5分，典籍的知名度和诗句的优美程度
   - harmony（音韵和谐）：1-5分，读音是否流畅，声调是否和谐
   - wuxing（五行匹配）：1-5分，五行是否平衡
   - overall（综合评分）：0-100分，综合评价

请确保每个名字都有真实可靠的出处，不要编造典籍或诗句。
`.trim()
}

/**
 * 按八字起名的Prompt
 */
function generateBaziPrompt(request: NamingRequest): string {
  const { surname, gender, bazi, count = 10 } = request

  if (!bazi?.bazi) {
    throw new Error('八字信息不完整')
  }

  const { yearGanZhi, monthGanZhi, dayGanZhi, hourGanZhi, wuxingCount, xiyongshen } = bazi.bazi

  const genderText = gender === 'male' ? '男孩'
    : gender === 'female' ? '女孩'
    : '中性'

  // 五行统计文本
  const wuxingText = Object.entries(wuxingCount)
    .map(([wx, count]) => `${wx}:${count}个`)
    .join('，')

  // 喜用神文本
  const xiyongshenText = xiyongshen.join('、')

  return `
请为姓"${surname}"的${genderText}推荐${count}个名字，需要结合生辰八字，要求如下：

**生辰八字信息**：
- 年柱：${yearGanZhi}
- 月柱：${monthGanZhi}
- 日柱：${dayGanZhi}
- 时柱：${hourGanZhi}
- 五行统计：${wuxingText}
- 喜用神：${xiyongshenText}

**起名要求**：
1. **五行要求**：
   - 名字的五行属性应该包含喜用神：${xiyongshenText}
   - 优先选择能补充五行缺失的字
   - 五行之间要相生，避免相克

2. **来源要求**：
   - 严格来源于《诗经》、《楚辞》、唐诗、宋词等古典文献
   - 必须有明确的典籍出处和原文诗句

3. **名字要求**：
   - 音韵优美，寓意美好
   - 适合现代使用，避免生僻字
   - 男孩名字阳刚大气，女孩名字婉约优雅

4. **输出格式**：
   - 严格按照JSON格式输出（格式同上）
   - 每个字必须标注正确的五行属性
   - wuxing评分要重点考虑与八字的匹配度

请确保名字的五行属性与八字喜用神高度匹配，同时不失文化内涵和美感。
`.trim()
}
```

---

## 4. 状态管理设计

### 4.1 起名状态 - stores/naming.ts

```typescript
import { defineStore } from 'pinia'
import { Name, NamingRequest } from '@/types/name'
import { generateNames } from '@/api/ai'

export const useNamingStore = defineStore('naming', {
  state: () => ({
    // 当前模式
    mode: 'surname' as 'surname' | 'bazi',

    // 起名请求参数
    request: null as NamingRequest | null,

    // 生成的名字列表
    names: [] as Name[],

    // 加载状态
    loading: false,

    // 错误信息
    error: null as string | null,

    // 当前查看的名字
    currentName: null as Name | null
  }),

  getters: {
    // 过滤后的名字列表
    filteredNames: (state) => {
      if (!state.request?.filter) return state.names

      const filter = state.request.filter
      return state.names.filter(name => {
        // 按典籍来源筛选
        if (filter.source && filter.source.length > 0) {
          if (!filter.source.includes(name.source.book)) {
            return false
          }
        }

        // 按五行筛选
        if (filter.wuxing && filter.wuxing.length > 0) {
          const hasWuXing = name.characters.some(char =>
            filter.wuxing?.includes(char.wuxing)
          )
          if (!hasWuXing) return false
        }

        // 按字数筛选
        if (filter.charCount) {
          if (name.givenName.length !== filter.charCount) {
            return false
          }
        }

        return true
      })
    },

    // 排序后的名字列表
    sortedNames: (state) => {
      return [...state.names].sort((a, b) => {
        return b.score.overall - a.score.overall
      })
    }
  },

  actions: {
    // 生成名字
    async generateNames(request: NamingRequest) {
      this.loading = true
      this.error = null
      this.request = request

      try {
        this.names = await generateNames(request)
      } catch (err: any) {
        this.error = err.message || '生成失败'
        throw err
      } finally {
        this.loading = false
      }
    },

    // 查看名字详情
    viewName(name: Name) {
      this.currentName = name
    },

    // 清空名字列表
    clearNames() {
      this.names = []
      this.currentName = null
    },

    // 更新筛选条件
    updateFilter(filter: any) {
      if (this.request) {
        this.request.filter = { ...this.request.filter, ...filter }
      }
    }
  }
})
```

### 4.2 收藏状态 - stores/collection.ts

```typescript
import { defineStore } from 'pinia'
import { Name } from '@/types/name'
import { saveToStorage, getFromStorage } from '@/utils/storage'

const COLLECTION_KEY = 'naming_collection'

export const useCollectionStore = defineStore('collection', {
  state: () => ({
    // 收藏的名字列表
    collections: [] as Name[],

    // 对比选中的名字
    comparisonList: [] as Name[]
  }),

  getters: {
    // 是否已收藏
    isCollected: (state) => (nameId: string) => {
      return state.collections.some(item => item.id === nameId)
    },

    // 收藏数量
    collectionCount: (state) => state.collections.length,

    // 对比数量
    comparisonCount: (state) => state.comparisonList.length
  },

  actions: {
    // 初始化（从localStorage加载）
    init() {
      const data = getFromStorage(COLLECTION_KEY)
      if (data) {
        this.collections = data
      }
    },

    // 添加收藏
    addCollection(name: Name) {
      if (!this.isCollected(name.id)) {
        this.collections.unshift(name)
        this.saveToStorage()
      }
    },

    // 移除收藏
    removeCollection(nameId: string) {
      const index = this.collections.findIndex(item => item.id === nameId)
      if (index > -1) {
        this.collections.splice(index, 1)
        this.saveToStorage()
      }
    },

    // 切换收藏状态
    toggleCollection(name: Name) {
      if (this.isCollected(name.id)) {
        this.removeCollection(name.id)
      } else {
        this.addCollection(name)
      }
    },

    // 清空收藏
    clearCollection() {
      this.collections = []
      this.saveToStorage()
    },

    // 添加到对比
    addToComparison(name: Name) {
      if (this.comparisonList.length >= 3) {
        throw new Error('最多只能对比3个名字')
      }
      if (!this.comparisonList.find(item => item.id === name.id)) {
        this.comparisonList.push(name)
      }
    },

    // 从对比中移除
    removeFromComparison(nameId: string) {
      const index = this.comparisonList.findIndex(item => item.id === nameId)
      if (index > -1) {
        this.comparisonList.splice(index, 1)
      }
    },

    // 清空对比列表
    clearComparison() {
      this.comparisonList = []
    },

    // 保存到localStorage
    saveToStorage() {
      saveToStorage(COLLECTION_KEY, this.collections)
    }
  }
})
```

---

## 5. 核心组件设计

### 5.1 名字卡片组件 - NameCard.vue

```vue
<template>
  <div class="name-card" :class="{ collected: isCollected }">
    <!-- 收藏按钮 -->
    <div class="collect-btn" @click.stop="handleCollect">
      <i :class="isCollected ? 'el-icon-heart-filled' : 'el-icon-heart'" />
    </div>

    <!-- 名字主体 -->
    <div class="name-main" @click="handleView">
      <h3 class="full-name">{{ name.fullName }}</h3>
      <p class="pinyin">{{ name.pinyin }}</p>

      <!-- 五行标签 -->
      <div class="wuxing-tags">
        <el-tag
          v-for="char in name.characters"
          :key="char.char"
          :type="getWuxingType(char.wuxing)"
          size="small"
        >
          {{ char.char }}·{{ char.wuxing }}
        </el-tag>
      </div>

      <!-- 出处 -->
      <div class="source">
        <i class="el-icon-document" />
        <span>{{ name.source.book }}</span>
      </div>

      <!-- 诗句 -->
      <blockquote class="verse">
        {{ name.source.verse }}
      </blockquote>

      <!-- 寓意 -->
      <p class="meaning">
        {{ truncateMeaning(name.meaning, 50) }}
      </p>

      <!-- 评分 -->
      <div class="score">
        <span class="score-label">综合评分</span>
        <span class="score-value">{{ name.score.overall }}</span>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { computed } from 'vue'
import { Name, WuXing } from '@/types/name'
import { useCollectionStore } from '@/stores/collection'

interface Props {
  name: Name
}

const props = defineProps<Props>()
const emit = defineEmits<{
  view: [name: Name]
}>()

const collectionStore = useCollectionStore()

// 是否已收藏
const isCollected = computed(() => {
  return collectionStore.isCollected(props.name.id)
})

// 处理收藏
const handleCollect = () => {
  collectionStore.toggleCollection(props.name)
}

// 查看详情
const handleView = () => {
  emit('view', props.name)
}

// 获取五行对应的标签类型
const getWuxingType = (wuxing: WuXing) => {
  const typeMap = {
    '金': 'warning',
    '木': 'success',
    '水': 'primary',
    '火': 'danger',
    '土': 'info'
  }
  return typeMap[wuxing]
}

// 截断寓意文字
const truncateMeaning = (text: string, maxLength: number) => {
  if (text.length <= maxLength) return text
  return text.substring(0, maxLength) + '...'
}
</script>

<style lang="scss" scoped>
.name-card {
  position: relative;
  background: #fff;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  padding: 20px;
  cursor: pointer;
  transition: all 0.3s ease;

  &:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    transform: translateY(-4px);
  }

  &.collected {
    border-color: #c9302c;
  }
}

.collect-btn {
  position: absolute;
  top: 15px;
  right: 15px;
  font-size: 20px;
  color: #999;
  cursor: pointer;
  transition: all 0.3s;

  &:hover {
    color: #c9302c;
    transform: scale(1.2);
  }

  .el-icon-heart-filled {
    color: #c9302c;
  }
}

.full-name {
  font-size: 28px;
  font-family: 'STKaiti', 'KaiTi', serif;
  color: #1a1a1a;
  margin: 0 0 8px 0;
}

.pinyin {
  font-size: 14px;
  color: #999;
  margin: 0 0 15px 0;
}

.wuxing-tags {
  margin-bottom: 15px;

  .el-tag {
    margin-right: 8px;
  }
}

.source {
  display: flex;
  align-items: center;
  gap: 5px;
  font-size: 13px;
  color: #666;
  margin-bottom: 10px;

  i {
    font-size: 14px;
  }
}

.verse {
  font-family: 'STKaiti', 'KaiTi', serif;
  font-size: 15px;
  line-height: 1.8;
  color: #4a4a4a;
  margin: 15px 0;
  padding-left: 15px;
  border-left: 3px solid #c9302c;
  font-style: italic;
}

.meaning {
  font-size: 14px;
  color: #666;
  line-height: 1.6;
  margin: 10px 0;
}

.score {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 15px;
  padding-top: 15px;
  border-top: 1px solid #e0e0e0;

  .score-label {
    font-size: 13px;
    color: #999;
  }

  .score-value {
    font-size: 24px;
    font-weight: bold;
    color: #c9302c;
  }
}
</style>
```

---

## 6. 开发规范

### 6.1 代码规范
- 使用TypeScript进行类型约束
- 遵循Vue 3 Composition API风格
- 使用ESLint + Prettier保证代码风格一致
- 组件命名采用PascalCase
- 文件命名采用kebab-case

### 6.2 Git规范
```
feat: 新功能
fix: 修复bug
docs: 文档更新
style: 代码格式调整
refactor: 重构
test: 测试相关
chore: 构建工具或辅助工具的变动
```

### 6.3 注释规范
```typescript
/**
 * 函数功能描述
 * @param param1 - 参数1说明
 * @param param2 - 参数2说明
 * @returns 返回值说明
 */
```

---

## 7. 部署方案

### 7.1 构建配置

#### vite.config.ts
```typescript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src')
    }
  },
  build: {
    outDir: 'dist',
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true
      }
    },
    rollupOptions: {
      output: {
        manualChunks: {
          'vue-vendor': ['vue', 'vue-router', 'pinia'],
          'ui-vendor': ['element-plus'],
          'utils': ['axios', 'dayjs']
        }
      }
    }
  },
  server: {
    port: 3000,
    open: true
  }
})
```

### 7.2 环境变量配置

#### .env.development
```
VITE_APP_TITLE=诗韵取名阁
VITE_AI_API_URL=https://api.openai.com/v1
VITE_AI_API_KEY=your_api_key_here
```

#### .env.production
```
VITE_APP_TITLE=诗韵取名阁
VITE_AI_API_URL=https://api.openai.com/v1
VITE_AI_API_KEY=your_production_api_key
```

### 7.3 部署步骤

#### 静态托管（推荐）
1. **Vercel部署**
```bash
npm run build
vercel --prod
```

2. **Netlify部署**
```bash
npm run build
netlify deploy --prod --dir=dist
```

3. **GitHub Pages**
```bash
npm run build
# 推送dist目录到gh-pages分支
```

#### 服务器部署（Nginx）
```nginx
server {
    listen 80;
    server_name naming.example.com;

    root /var/www/naming-tool/dist;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # 静态资源缓存
    location ~* \.(js|css|png|jpg|jpeg|gif|svg|ico)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

---

## 8. 性能优化

### 8.1 代码分割
- 路由懒加载
- 组件异步加载
- 第三方库按需引入

### 8.2 资源优化
- 图片压缩和WebP格式
- 字体子集化
- CSS和JS压缩

### 8.3 加载优化
- 首屏关键CSS内联
- 预加载关键资源
- 骨架屏loading

### 8.4 缓存策略
- LocalStorage缓存收藏数据
- SessionStorage缓存生成结果
- Service Worker离线缓存

---

## 9. 测试方案

### 9.1 单元测试
- 使用Vitest进行单元测试
- 测试工具函数（八字计算、五行判断等）
- 测试Pinia store

### 9.2 组件测试
- 使用Vue Test Utils
- 测试核心组件交互

### 9.3 E2E测试
- 使用Playwright
- 测试完整业务流程

---

## 10. 后续扩展

### 10.1 功能扩展
- 用户账号系统
- 社区评论分享
- 专家人工审核
- 付费高级功能（更多典籍、名人名字库）

### 10.2 技术优化
- 建立本地典籍数据库
- AI模型微调
- 多语言支持

---

**文档版本：** V1.0
**创建日期：** 2025-11-13
**最后更新：** 2025-11-13
**文档作者：** Claude Code
